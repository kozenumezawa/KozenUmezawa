<!doctype html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>内部保持無し</title>
    <style>canvas { width: 100%; height: 100% }</style>
</head>
<body>
	<script src="three.min.js"></script>
	<script>
	var scene;
	var camera;
	var renderer = new THREE.WebGLRenderer();
	renderer.setSize( window.innerWidth, window.innerHeight ); 
	document.body.appendChild( renderer.domElement );

	var vss =[];

	function init_points( num )
	{
		scene = new THREE.Scene();
		camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );		
	
		// 頂点の総数　phe+Chromeでは500万点くらいが限界っぽい
		var numpoints = num;
		// 配列に格納しないパターン
		var i = 0;
		var vss = [];

		// パーティクルを作る
		var geometry = new THREE.Geometry();
		var colors = [];
		for ( i = 0; i<numpoints; i++ )
		{
			var vertex = new THREE.Vector3();
			vertex.x = Math.random() * 10 -  5;
			vertex.y = Math.random() * 10 -  5;
			vertex.z = Math.random() * 10 -  5;
			geometry.vertices.push( vertex );

			var color = new THREE.Color( 0xffffff );
			color.setRGB( Math.random(), Math.random(), Math.random()  );
			colors.push(color);
	 	}
	 	
		geometry.colors = colors;
		var material = new THREE.PointCloudMaterial({size: 0.01, vertexColors: true,});
		particles = new THREE.PointCloud(geometry, material);
  		particles.sortParticles = false
  		scene.add(particles);	
		camera.position.z = 10;
	}
	
	function render() {
		requestAnimationFrame(render);
    		
		particles.rotation.x += 0.01;
		particles.rotation.y += 0.01;
		particles.rotation.z += 0.01;
    		
		renderer.render(scene, camera);
	}
	
	function Go()
	{
        var num = test_form.NumOfPoints.value;  //テキストエリアの値を取得
        init_points( num );	render();
    }

	</script>
	
	<form name="test_form" action="datainternal.html">
	<input type="text" name="NumOfPoints">
	<input type="button" value="GO" onclick="Go()">
	</form>
	
</body>
</html>